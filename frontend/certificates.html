<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificates - E-Learning Platform</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">E-Learning</div>
        <div class="nav-menu">
            <a href="dashboard.html">Dashboard</a>
            <a href="courses.html">All Courses</a>
            <a href="leaderboard.html">Leaderboard</a>
            <a href="certificates.html" class="active">Certificates</a>
            <a href="#" id="logoutBtn">Logout</a>
        </div>
        <div class="nav-user" id="navUser"></div>
    </nav>

    <div class="container">
        <h1>Your Certificates</h1>
        <p class="subtitle">Certificates earned by completing courses with 80% or higher score</p>
        
        <div id="certificatesList">
            <div class="empty-state">Loading certificates...</div>
        </div>
    </div>

    <script src="assets/js/main.js"></script>
    <script>
        const student = checkAuth();
        
        if (student) {
            loadCertificates();
        }
        
        async function loadCertificates() {
            try {
                const response = await fetch(`${API_URL}/students/${student.student_id}/certificates`);
                const data = await response.json();
                
                if (data.success) {
                    displayCertificates(data.certificates);
                } else {
                    document.getElementById('certificatesList').innerHTML = 
                        '<div class="empty-state">Error loading certificates. Please try again.</div>';
                }
            } catch (error) {
                console.error('Error loading certificates:', error);
                document.getElementById('certificatesList').innerHTML = 
                    '<div class="empty-state">Error loading certificates. Please check your connection.</div>';
            }
        }
        
        function displayCertificates(certificates) {
            const certificatesList = document.getElementById('certificatesList');
            
            if (certificates.length === 0) {
                certificatesList.innerHTML = `
                    <div class="empty-state">
                        <h3>No certificates yet</h3>
                        <p>Complete courses with 80% or higher score to earn certificates!</p>
                        <a href="courses.html" class="btn btn-primary">Browse Courses</a>
                    </div>
                `;
                return;
            }
            
            certificatesList.innerHTML = certificates.map(cert => `
                <div class="certificate-card">
                    <div class="certificate-header">
                        <h2>Certificate of Completion</h2>
                        <div class="cert-code">Certificate Code: ${cert.certificate_code}</div>
                    </div>
                    <div class="certificate-body">
                        <h3>${cert.course_title}</h3>
                        <p>This certifies that</p>
                        <h3>${student.full_name}</h3>
                        <p>has successfully completed the course</p>
                        <p><strong>${cert.course_title}</strong></p>
                        <div class="instructor">Instructor: ${cert.instructor}</div>
                        <div class="date">Issued on: ${formatDate(cert.issued_at)}</div>
                    </div>
                </div>
            `).join('');
        }
        
        // Initialize navigation
        initNav();
    </script>
</body>
</html>
